#include "./lib/lib.h"
#include "monster.h"
#include "dice.h"
#include "battle_manager.h"

static char MAX_GROUP[10] = {1,2,3,4,4,4,4,4,4,4};

MonsterData MONSTER_MST[101] = {
{0,5,"Slime",6,"Slimes",12,"Bubbly slime",13,"Bubbly slimes",0x08,{2,2,0},{1,3,1},12,1,{{1,1,0}},0,0,10,0,1,26,0,0,0,0,0,0,55},
{1,14,"Small humanoid",15,"Small humanoids",3,"Orc",4,"Orcs",0x00,{3,2,0},{1,4,0},10,1,{{1,4,0}},0,0,10,0,2,51,0,0,0,0,0,0,235},
{2,14,"Small humanoid",15,"Small humanoids",6,"Kobold",7,"Kobolds",0x00,{2,2,1},{2,3,1},8,2,{{1,2,1},{1,2,1}},0,0,10,0,1,38,0,0,0,0,0,0,415},
{3,8,"Skeleton",9,"Skeletons",13,"Undead kobold",14,"Undead kobolds",0x0A,{1,6,1},{2,3,2},10,1,{{1,4,1}},0,0,10,0,2,26,0,0,0,0,0,0,230},
{4,11,"Scruffy man",11,"Scruffy men",5,"Rogue",6,"Rogues",0x03,{1,4,1},{2,5,1},10,2,{{1,4,0},{2,2,1}},0,0,10,0,1,51,0,0,0,0,0,0,380},
{5,11,"Scruffy man",11,"Scruffy men",10,"Bushwacker",11,"Bushwackers",0x00,{1,4,1},{3,6,1},8,2,{{1,6,1},{2,4,1}},0,0,10,0,7,51,0,0,0,0,0,0,620},
{6,12,"Man in chain",12,"Men in chain",10,"Highwayman",10,"Highwaymen",0x00,{2,4,0},{3,4,2},6,4,{{1,2,1},{1,2,1},{1,2,1},{1,2,1}},0,0,10,0,7,51,0,0,0,0,0,0,840},
{7,14,"Weird humanoid",15,"Weird humanoids",6,"Zombie",7,"Zombies",0x0A,{1,6,1},{1,10,1},4,1,{{1,6,0}},0,0,10,0,8,51,0,0,0,0,0,0,520},
{8,5,"Slime",6,"Slimes",13,"Creeping crud",14,"Creeping cruds",0x08,{1,6,1},{3,4,0},6,1,{{1,3,1}},0,0,10,0,0,61,0,0,0,0,0,0,550},
{9,9,"Gas cloud",10,"Gas clouds",9,"Gas cloud",10,"Gas clouds",0x0D,{2,4,0},{2,4,0},10,1,{{1,4,0}},0,0,10,0,0,38,2,0,0,0,0,0,350},
{10,12,"Man in robes",12,"Men in robes",10,"Lvl 1 Mage",11,"Lvl 1 Mages",0x01,{2,2,0},{1,4,1},4,1,{{2,2,0}},0,0,11,1,6,51,1,0,0,0,0,0,475},
{11,6,"Cleric",7,"Clerics",12,"Lvl 1 Cleric",13,"Lvl 1 Clerics",0x02,{1,4,1},{1,8,0},5,1,{{1,8,0}},0,0,11,1,4,64,0,1,0,0,0,0,515},
{12,12,"Small object",13,"Small objects",13,"Creeping coin",14,"Creeping coins",0x0D,{9,1,0},{1,1,0},4,1,{{1,1,0}},0,0,4,2,12,255,0,0,0,0,0,0,920},
{13,12,"Kimonoed man",12,"Kimonoed men",11,"Lvl 1 Ninja",12,"Lvl 1 Ninjas",0x00,{2,4,0},{2,4,2},5,3,{{1,4,0},{1,4,0},{1,4,0}},0,0,11,1,13,51,0,0,0,0,0,0,600},
{14,6,"Rabbit",7,"Rabbits",12,"Vorpal bunny",14,"Vorpal bunnies",0x08,{2,3,2},{3,6,2},6,2,{{1,6,0},{1,8,0}},0,0,11,1,15,51,0,0,0,0,0,0,735},
{15,12,"Giant rodent",13,"Giant rodents",8,"Capybara",9,"Capybaras",0x08,{2,4,1},{4,4,0},8,1,{{1,10,0}},0,0,11,1,17,51,0,0,0,0,0,0,520},
{16,9,"Amphibian",10,"Amphibians",10,"Giant toad",11,"Giant toads",0x08,{2,2,4},{4,5,0},7,3,{{1,4,0},{1,6,0},{2,3,2}},0,0,11,1,17,51,0,0,0,0,0,0,795},
{17,9,"Mangy dog",10,"Mangy dogs",6,"Coyote",7,"Coyotes",0x08,{4,2,0},{4,6,0},8,1,{{4,4,0}},0,0,11,1,14,64,0,0,0,0,0,0,780},
{18,6,"Cleric",7,"Clerics",12,"Lvl 3 Cleric",13,"Lvl 3 Clerics",0x02,{2,2,3},{3,8,1},4,1,{{1,8,2}},0,0,11,1,11,77,0,2,0,0,0,0,990},
{19,12,"Kimonoed man",12,"Kimonoed men",13,"Lvl 3 Samurai",13,"Lvl 3 Samurai",0x00,{4,2,0},{3,6,4},5,3,{{1,4,1},{1,6,1},{1,4,1}},0,0,11,1,12,51,1,0,0,0,0,0,795},
{20,12,"Kimonoed man",12,"Kimonoed men",11,"Lvl 3 Ninja",12,"Lvl 3 Ninjas",0x00,{2,4,2},{3,8,0},3,5,{{1,4,0},{1,4,0},{1,4,0},{1,4,0},{1,4,0}},0,0,12,2,13,51,0,0,0,0,0,0,1360},
{21,4,"Bear",5,"Bears",9,"Were bear",10,"Were bears",0x08,{2,3,2},{5,8,0},6,1,{{3,6,1}},0,1,12,2,14,77,0,0,0,0,0,0,1320},
{22,3,"Fly",5,"Flies",10,"Dragon fly",12,"Dragon flies",0x07,{1,3,1},{2,8,0},4,3,{{1,4,0},{1,4,0},{1,6,0}},0,0,12,2,0,0,0,0,0,0,0,0,1275},
{23,14,"Weird humanoid",15,"Weird humanoids",14,"Rotting corpse",15,"Rotting corpses",0x0A,{1,5,0},{2,8,0},6,3,{{1,3,0},{1,3,0},{1,6,0}},0,0,12,2,34,26,0,0,0,0,0,0,680},
{24,4,"Ogre",5,"Ogres",4,"Ogre",5,"Ogres",0x00,{1,8,0},{4,8,1},5,1,{{2,6,0}},0,0,12,2,14,51,0,0,0,0,0,0,960},
{25,6,"Insect",7,"Insects",11,"Huge spider",12,"Huge spiders",0x0C,{1,8,0},{2,8,2},6,1,{{1,6,0}},0,0,12,2,27,26,0,0,0,0,0,0,600},
{26,7,"Wererat",8,"Wererats",7,"Wererat",8,"Wererats",0x09,{1,4,0},{3,8,1},6,1,{{1,8,0}},0,0,12,2,17,128,0,0,0,0,0,0,755},
{27,6,"Insect",7,"Insects",13,"Boring beetle",14,"Boring beetles",0x0C,{1,8,0},{5,8,0},3,1,{{5,4,0}},0,0,12,2,25,51,0,0,0,0,0,0,1120},
{28,6,"Dragon",7,"Dragons",10,"Gas dragon",11,"Gas dragons",0x07,{1,4,0},{5,8,0},3,3,{{1,4,0},{1,4,0},{3,6,0}},0,0,12,2,22,102,1,0,0,0,0,0,2075},
{29,6,"Cleric",7,"Clerics",6,"Cleric",7,"Clerics",0x02,{1,6,0},{3,8,1},4,1,{{1,6,2}},0,0,12,2,28,154,0,2,0,0,0,0,870},
{30,12,"Man in armor",12,"Men in armor",9,"Swordsman",9,"Swordsmen",0x00,{1,6,0},{3,10,0},3,1,{{2,7,0}},0,0,13,3,32,90,0,0,0,0,0,0,960},
{31,6,"Insect",7,"Insects",11,"Huge spider",12,"Huge spiders",0x0C,{1,8,0},{2,8,2},6,1,{{1,6,0}},0,0,13,3,37,26,0,0,0,0,0,0,600},
{32,6,"Animal",7,"Animals",10,"Attack dog",11,"Attack dogs",0x08,{1,6,0},{4,8,0},1,1,{{1,6,0}},0,0,13,3,22,51,0,0,0,0,0,0,1120},
{33,8,"Gargoyle",9,"Gargoyles",8,"Gargoyle",9,"Gargoyles",0x0D,{1,6,0},{4,8,4},5,4,{{1,3,0},{1,3,0},{1,6,0},{1,4,0}},0,0,13,3,0,0,0,0,0,0,0,0,2435},
{34,13,"Unseen entity",13,"Unseen entity",10,"Grave mist",11,"Grave mists",0x0A,{1,6,0},{4,8,0},4,3,{{1,4,0},{1,4,0},{1,8,0}},0,0,13,3,37,51,0,0,0,0,0,0,1080},
{35,6,"Animal",7,"Animals",12,"Dragon puppy",14,"Dragon puppies",0x07,{1,6,0},{5,10,0},4,1,{{1,10,0}},0,0,13,3,26,26,0,0,0,0,0,0,2280},
{36,4,"Wolf",6,"Wolves",8,"Werewolf",10,"Werewolves",0x09,{1,6,0},{4,8,3},5,2,{{2,4,0},{2,4,0}},0,0,13,3,26,64,0,0,0,0,0,0,975},
{37,13,"Unseen entity",13,"Unseen entity",5,"Shade",6,"Shades",0x0A,{1,6,0},{3,8,3},7,1,{{1,4,1}},0,0,13,3,23,51,0,0,0,0,0,0,875},
{38,6,"Cleric",7,"Clerics",6,"Wizard",7,"Wizards",0x02,{1,6,0},{4,8,0},4,1,{{1,10,0}},0,0,13,3,39,26,1,3,0,0,0,0,1135},
{39,12,"Man in armor",12,"Men in armor",12,"Minor daimyo",13,"Minor daimyos",0x00,{1,6,0},{4,10,0},2,1,{{1,12,0}},0,0,13,3,38,51,0,0,0,0,0,0,1200},
{40,12,"Man in robes",12,"Men in robes",10,"Lvl 5 Mage",11,"Lvl 5 Mages",0x01,{1,6,0},{5,4,0},10,1,{{1,4,0}},0,0,14,4,41,51,3,0,0,0,0,0,620},
{41,14,"Man in leather",14,"Men in leather",11,"Lvl 4 Thief",13,"Lvl 4 Thieves",0x03,{1,6,0},{4,8,3},10,2,{{1,6,0},{2,6,0}},0,0,14,4,38,51,0,0,0,0,0,0,740},
{42,6,"Animal",7,"Animals",11,"Killer wolf",13,"Killer wolves",0x08,{1,6,0},{6,8,0},0,2,{{2,4,0},{2,4,0}},0,0,14,4,35,38,0,0,0,0,0,0,1460},
{43,13,"Unseen entity",15,"Unseen entities",6,"Spirit",7,"Spitits",0x06,{1,6,0},{7,3,2},2,1,{{1,4,0}},0,1,22,4,33,51,3,0,0,0,0,0,1405},
{44,6,"Insect",7,"Insects",12,"Giant spider",13,"Giant spiders",0x0C,{1,6,0},{4,8,4},4,1,{{2,4,0}},0,0,22,4,25,51,0,0,0,0,0,0,960},
{45,6,"Animal",7,"Animals",9,"Weretiger",10,"Weretigers",0x09,{1,8,0},{5,8,0},4,3,{{2,6,0},{2,6,0},{1,4,0}},0,1,14,4,36,51,0,0,0,0,0,0,1405},
{46,14,"Strange animal",15,"Strange animals",12,"Medusalizard",13,"Medusalizards",0x06,{1,6,0},{5,8,0},6,1,{{1,3,0}},0,0,22,4,43,51,0,0,0,0,0,0,1040},
{47,6,"Cleric",7,"Clerics",12,"Lvl 5 Cleric",13,"Lvl 5 Clerics",0x02,{1,5,0},{5,8,0},4,1,{{1,6,2}},0,0,14,4,48,51,0,3,0,0,0,0,1220},
{48,12,"Man in black",12,"Men in black",11,"Lvl 6 Ninja",12,"Lvl 6 Ninjas",0x00,{1,5,0},{6,10},6,3,{{1,6,0},{1,6,0},{1,6,0}},0,0,14,4,50,51,0,0,0,0,0,0,1520},
{49,12,"Man in robes",12,"Men in robes",10,"Lvl 7 Mage",11,"Lvl 7 Mages",0x01,{1,6,0},{7,4,0},8,1,{{1,4,0}},0,0,14,4,48,51,4,0,0,0,0,0,1000},
{50,14,"Man in leather",14,"Men in leather",12,"Master Thief",14,"Master Thieves",0x03,{1,6,0},{4,6,0},4,3,{{1,6,0},{1,6,0},{2,6,0}},0,0,15,5,47,26,0,0,0,0,0,0,960},
{51,12,"Man in armor",12,"Men in armor",12,"Major daimyo",13,"Major daimyos",0x00,{1,5,0},{7,12},0,2,{{1,10,0},{1,4,0}},0,0,15,5,47,128,0,0,0,0,0,0,2340},
{52,6,"Cleric",7,"Clerics",11,"High Cleric",12,"High Clerics",0x02,{1,6,0},{8,8,0},3,1,{{1,8,2}},0,0,23,5,53,51,0,5,0,0,0,0,2160},
{53,12,"Man in armor",12,"Men in armor",13,"Champ Samurai",13,"Champ Samurai",0x00,{1,6,0},{10,10},2,1,{{1,12,2}},0,0,23,5,52,64,1,0,0,0,0,0,2395},
{54,12,"Man in robes",12,"Men in robes",9,"Arch Mage",10,"Arch Mages",0x01,{1,6,0},{8,4,2},9,1,{{1,4,0}},0,0,23,5,53,77,2,0,0,0,0,0,790},
{55,14,"Man in leather",14,"Men in leather",12,"Master Thief",14,"Master Thieves",0x03,{1,6,0},{6,6,0},3,2,{{1,8,0},{3,8,0}},0,0,15,5,54,64,0,0,0,0,0,0,1140},
{56,14,"Strange animal",15,"Strange animals",10,"Gaze hound",11,"Gaze hounds",0x08,{1,5,0},{4,8,0},-1,1,{{1,2,0}},0,0,15,5,56,51,0,0,0,0,0,0,1235},
{57,4,"Ogre",5,"Ogres",9,"Ogre Lord",10,"Ogre Lords",0x01,{1,5,0},{8,8,0},4,1,{{1,12,0}},0,1,15,5,58,26,3,0,0,0,0,0,1790},
{58,14,"Strange animal",15,"Strange animals",5,"Troll",6,"Trolls",0x00,{1,3,0},{6,8,6},4,3,{{1,4,4},{1,4,4},{1,4,4}},0,3,15,5,58,13,0,0,0,0,0,0,1720},
{59,13,"Unseen entity",15,"Unseen entities",11,"Lifestealer",12,"Lifestealers",0x0A,{1,1,0},{5,8,3},3,1,{{1,4,0}},2,0,15,5,59,128,3,3,0,0,0,0,2240},
{60,13,"Unseen entity",15,"Unseen entities",12,"Nightstalker",13,"Nightstalkers",0x0A,{2,3,0},{5,8,3},4,1,{{1,6,0}},1,0,16,6,57,59,0,0,0,0,0,0,1635},
{61,14,"Strange animal",15,"Strange animals",6,"Wyvern",7,"Wyverns",0x08,{1,6,0},{7,8,7},3,2,{{2,8,0},{1,6,0}},0,0,16,6,43,51,0,0,0,0,0,0,1540},
{62,6,"Cleric",7,"Clerics",12,"Lvl 8 Cleric",13,"Lvl 8 Clerics",0x02,{1,5,0},{7,8,0},3,1,{{1,8,0}},0,0,16,6,61,51,0,4,0,0,0,0,1720},
{63,12,"Man in armor",12,"Men in armor",14,"Lvl 10 Fighter",15,"Lvl 10 Fighters",0x00,{1,6,0},{7,10,0},0,2,{{1,12,0},{1,12,0}},0,0,16,6,63,26,0,0,0,0,0,0,1900},
{64,12,"Man in robes",12,"Men in robes",10,"Lvl 7 Mage",11,"Lvl 7 Mages",0x01,{1,6,0},{7,4,0},8,1,{{1,4,0}},0,0,16,6,61,77,5,0,0,0,0,0,1240},
{65,14,"Man in leather",14,"Men in leather",11,"Lvl 7 Thief",13,"Lvl 7 Thieves",0x03,{1,5,0},{7,6,0},4,2,{{1,8,0},{3,8,0}},0,0,16,6,62,51,0,0,0,0,0,0,1220},
{66,4,"Monk",5,"Monks",11,"Lvl 8 Ninja",12,"Lvl 8 Ninjas",0x00,{1,3,0},{8,4,0},4,2,{{2,6,0},{1,6,0}},0,0,16,6,60,51,0,0,0,0,0,0,1020},
{67,5,"Giant",6,"Giants",11,"Earth giant",12,"Earth giants",0x05,{1,5,0},{1,1,40},9,2,{{2,8,0},{2,8,0}},0,0,16,6,0,0,0,0,0,0,0,0,20675},
{68,5,"Demon",6,"Demons",12,"Lesser demon",13,"Lesser demons",0x0B,{1,1,0},{10,8,0},4,5,{{2,6,0},{2,6,0},{1,3,0},{1,3,0},{1,4,4}},0,0,16,6,66,205,3,0,0,0,0,0,5100},
{69,14,"Strange animal",15,"Strange animals",7,"Chimera",8,"Chimeras",0x08,{1,4,0},{9,6,0},2,6,{{1,3,0},{1,3,0},{1,4,0},{1,4,0},{2,4,0},{3,4,0}},0,0,16,6,54,51,0,0,0,0,0,0,3515},
{70,5,"Giant",6,"Giants",10,"Fire giant",11,"Fire giants",0x05,{1,4,0},{11,8,4},3,1,{{5,6,0}},0,0,17,7,68,26,0,0,0,0,0,0,2115},
{71,14,"Strange animal",15,"Strange animals",6,"Gorgon",7,"Gorgons",0x06,{1,1,0},{8,8,0},2,1,{{2,6,0}},0,0,17,7,69,128,0,0,0,0,0,0,2920},
{72,6,"Cleric",7,"Clerics",12,"Lvl 8 Wizard",13,"Lvl 8 Wizards",0x02,{1,6,0},{8,8,0},2,1,{{1,8,4}},0,0,17,7,71,51,3,4,0,0,0,0,2060},
{73,12,"Man in armor",12,"Men in armor",13,"Lvl 8 Fighter",14,"Lvl 8 Fighters",0x00,{1,6,0},{8,10,0},-1,2,{{1,12,2},{1,12,2}},0,0,17,7,73,51,0,0,0,0,0,0,2140},
{74,12,"Man in robes",12,"Men in robes",11,"Lvl 10 Mage",12,"Lvl 10 Mages",0x01,{1,6,0},{10,4,0},10,1,{{1,4,0}},0,0,17,7,71,77,5,0,0,0,0,0,1400},
{75,14,"Man in leather",14,"Men in leather",5,"Thief",7,"Thieves",0x03,{1,5,0},{9,6,0},4,4,{{1,8,0},{1,3,0},{3,8,0},{2,10,0}},0,0,17,7,71,51,0,0,0,0,0,0,1640},
{76,12,"Man in robes",12,"Men in robes",12,"Master Ninja",13,"Master Ninjas",0x00,{1,5,0},{10,4,0},3,3,{{1,10,3},{1,10,3},{1,10,3}},0,0,17,7,49,77,0,0,0,0,0,0,1280},
{77,13,"Unseen entity",15,"Unseen entities",14,"Murphy's ghost",15,"Murphy's ghosts",0x0A,{1,1,0},{10,10,10},-3,1,{{1,1,1}},0,1,3,3,77,205,0,0,0,0,0,0,4450},
{78,13,"Unseen entity",15,"Unseen entities",12,"Will o' wisp",13,"Will o' wisps",0x0D,{1,2,0},{10,8,0},-8,1,{{2,8,0}},0,0,17,7,0,0,0,0,0,0,0,0,43320},
{79,14,"Strange animal",15,"Strange animals",5,"Bleeb",6,"Bleebs",0x08,{1,8,0},{10,8,0},0,2,{{1,8,1},{1,8,1}},0,0,17,7,76,51,0,0,0,0,0,0,3300},
{80,5,"Giant",6,"Giants",11,"Frost giant",12,"Frost giants",0x05,{1,4,0},{1,8,50},6,1,{{3,10,0}},0,0,18,8,75,77,0,0,0,0,0,0,41355},
{81,6,"Dragon",6,"Dragon",11,"Fire dragon",12,"Fire dragons",0x07,{1,4,0},{12,8,0},-1,3,{{1,4,0},{1,4,0},{4,4,0}},0,0,18,8,0,0,5,0,0,0,0,0,5000},
{82,6,"Cleric",7,"Clerics",11,"High Cleric",12,"High Clerics",0x02,{1,1,0},{11,8,0},2,2,{{1,8,0},{1,8,0}},0,0,18,8,70,255,0,6,0,0,0,0,3300},
{83,12,"Man in robes",12,"Men in robes",11,"High wizard",12,"High wizards",0x01,{1,1,0},{12,4,0},4,1,{{1,4,0}},0,0,18,8,72,255,6,0,0,0,0,0,2395},
{84,14,"Man in leather",14,"Men in leather",12,"Master Thief",14,"Master Thieves",0x03,{1,1,0},{12,6,0},2,2,{{1,8,0},{5,8,0}},0,0,18,8,73,255,0,0,0,0,0,0,1935},
{85,12,"Man in robes",12,"Men in robes",8,"Hatamoto",9,"Hatamotos",0x00,{1,1,0},{12,4,0},-1,3,{{3,8,0},{3,8,0},{3,8,0}},0,0,18,8,74,255,0,0,0,0,0,0,1600},
{86,13,"Unseen entity",15,"Unseen entities",7,"Vampire",8,"Vampires",0x0A,{1,4,0},{11,8,0},-1,3,{{2,8,0},{1,4,0},{1,4,0}},2,1,18,8,86,38,3,0,0,0,0,0,3330},
{87,5,"Demon",6,"Demons",13,"Greater demon",14,"Greater demons",0x0B,{1,6,0},{11,8,0},-3,5,{{2,12,0},{1,6,0},{1,4,0},{1,4,0},{1,4,0}},0,1,18,8,66,179,5,0,0,0,0,0,44570},
{88,5,"Giant",6,"Giants",12,"Poison giant",13,"Poison giants",0x05,{1,4,0},{1,1,80},3,1,{{4,10,0}},0,0,18,8,78,128,0,0,0,0,0,0,41320},
{89,6,"Dragon",7,"Dragons",13,"Dragon zombie",14,"Dragon zombies",0x0A,{1,4,0},{12,8,0},-2,3,{{1,8,0},{1,8,0},{3,12,0}},0,0,18,8,79,26,5,0,0,0,0,0,5360},
{90,12,"Man in armor",12,"Men in armor",10,"Raver Lord",11,"Raver Lords",0x08,{1,1,0},{15,10,0},10,2,{{3,12,0},{3,12,0}},0,2,19,9,52,255,5,4,0,0,0,0,4155},
{91,8,"Conehead",9,"Coneheads",11,"High master",12,"High masters",0x00,{1,1,0},{15,4,0},-2,3,{{3,12,0},{3,12,0},{3,6,0}},0,0,19,9,85,255,0,0,0,0,0,0,3000},
{92,14,"Strange animal",15,"Strange animals",5,"Flack",5,"Fleck",0x08,{1,1,0},{15,12,0},-3,1,{{4,8,3}},0,0,19,9,77,255,0,0,0,0,0,0,9200},
{93,12,"Man in robes",12,"Men in robes",9,"Arch Mage",10,"Arch Mages",0x01,{1,1,0},{20,4,0},0,1,{{1,4,0}},0,0,19,9,83,255,6,0,0,0,0,0,3160},
{94,12,"Unseen being",13,"Unseen beings",8,"Maelific",9,"Maelifics",0x0A,{1,0,1},{25,4,0},-5,2,{{1,4,0},{1,0,1}},3,3,19,9,88,255,7,0,0,0,0,0,7460},
{95,13,"Unseen entity",15,"Unseen entities",12,"Vampire Lord",13,"Vampire Lords",0x0A,{1,1,0},{20,8,0},-5,1,{{1,4,0}},4,4,19,9,86,255,6,0,0,0,0,0,7320},
{96,12,"Man in robes",12,"Men in robes",11,"W E R D N A",11,"W E R D N A",0x01,{1,1,0},{10,10,200},-7,2,{{8,5,0},{8,5,0}},4,5,20,20,95,255,7,7,0,0,0,0,15880},
{97,13,"Man in kimono",13,"Men in kimono",10,"High Ninja",11,"High Ninjas",0x00,{1,1,0},{12,4,0},-1,3,{{3,8,0},{3,8,0},{3,8,0}},0,0,0,0,0,0,0,0,0,0,0,0,1600},
{98,6,"Cleric",7,"Clerics",11,"High Cleric",12,"High Clerics",0x02,{2,1,0},{8,8,0},2,1,{{1,8,4}},0,0,0,0,97,255,0,0,0,0,0,0,2200},
{99,12,"Man in robes",12,"Men in robes",10,"Lvl 7 Mage",11,"Lvl 7 Mages",0x01,{2,1,0},{7,4,0},8,1,{{1,4,0}},0,0,0,0,52,255,4,0,0,0,0,0,1000},
{100,12,"Man in armor",12,"Men in armor",13,"Lvl 7 Fighter",14,"Lvl 7 Fighters",0x00,{2,1,0},{7,10,0},0,2,{{1,12,0},{1,12,0}},0,0,21,21,49,255,0,0,0,0,0,0,1900},};

MonsterGroup MONSTER_GRP_MST[30] = {{255,1,{255},{4},{{0,1,2,3}},1},
{48,1,{255},{5},{{1,2,3,4,5}},1},
{16,1,{255},{3},{{4,5,6}},1},
{255,1,{255},{5},{{7,8,9,10,11}},2},
{48,1,{255},{5},{{8,9,10,11,12}},2},
{16,1,{255},{5},{{10,11,12,13,14}},2},
{255,1,{255},{10},{{15,16,17,18,19,20,21,22,23,24}},3},
{48,1,{255},{10},{{14,15,16,17,18,19,20,21,22,23}},3},
{16,1,{255},{10},{{20,21,22,23,24,25,26,27,28,29}},3},
{255,1,{255},{10},{{20,21,22,23,24,25,26,27,28,29}},4},
{48,1,{255},{10},{{25,26,27,28,29,30,31,32,33,34}},4},
{16,1,{255},{10},{{30,31,32,33,34,35,36,37,38,39}},4},
{255,2,{165,90},{10},{{30,31,32,33,34,35,36,37,38,39},{40,41,42,43,44,45,46,47,48,49}},5},
{48,3,{165,62,28},{10},{{30,31,32,33,34,35,36,37,38,39},{40,41,42,43,44,45,46,47,48,49},{50,51,52,53,54,55,56,57,58,59}},5},
{16,4,{185,53,15,7},{10},{{30,31,32,33,34,35,36,37,38,39},{40,41,42,43,44,45,46,47,48,49},{50,51,52,53,54,55,56,57,58,59},{60,61,62,63,64,65,67,68,69}},5},
{255,2,{165,90},{10},{{40,41,42,43,44,45,46,47,48,49},{50,51,52,53,54,55,56,57,58,59}},6},
{48,3,{165,62,28},{10},{{40,41,42,43,44,45,46,47,48,49},{50,51,52,53,54,55,56,57,58,59},{60,61,62,63,64,65,67,68,69}},6},
{16,4,{185,53,15,7},{10},{{40,41,42,43,44,45,46,47,48,49},{50,51,52,53,54,55,56,57,58,59},{60,61,62,63,64,65,67,68,69},{70,71,72,73,74,75,76,77,78,79}},6},
{255,2,{165,90},{10},{{45,46,47,48,49,50,51,52,53,54},{55,56,57,58,59,60,61,62,63,64}},7},
{48,3,{165,62,28},{10},{{45,46,47,48,49,50,51,52,53,54},{55,56,57,58,59,60,61,62,63,64},{65,66,67,68,69,70,71,72,73,74}},7},
{16,4,{185,53,15,7},{10},{{45,46,47,48,49,50,51,52,53,54},{55,56,57,58,59,60,61,62,63,64},{65,66,67,68,69,70,71,72,73,74},{75,76,77,78,79,80,81,82,83,84}},7},
{255,2,{165,90},{10},{{50,51,52,53,54,55,56,57,58,59},{60,61,62,63,64,65,66,67,68,69}},8},
{48,3,{165,62,28},{10},{{50,51,52,53,54,55,56,57,58,59},{60,61,62,63,64,65,66,67,68,69},{70,71,72,73,74,75,76,77,78,79}},8},
{16,4,{185,53,15,7},{10},{{50,51,52,53,54,55,56,57,58,59},{60,61,62,63,64,65,66,67,68,69},{70,71,72,73,74,75,76,77,78,79},{80,81,82,83,84,85,86,87,88,89}},8},
{255,2,{165,90},{10},{{55,56,57,58,59,60,61,62,63,64},{65,66,67,68,69,70,71,72,73,74}},9},
{48,3,{165,62,28},{10},{{55,56,57,58,59,60,61,62,63,64},{65,66,67,68,69,70,71,72,73,74},{75,76,77,78,79,80,81,82,83,84}},9},
{16,4,{185,53,15,7},{10},{{55,56,57,58,59,60,61,62,63,64},{65,66,67,68,69,70,71,72,73,74},{75,76,77,78,79,80,81,82,83,84},{85,86,87,88,89,90,91,92,93,94}},9},
{255,2,{165,90},{10},{{70,71,72,73,74,75,76,77,78,79},{80,81,82,83,84,85,86,87,88,89}},10},
{48,2,{165,90},{10},{{74,75,76,77,78,79,80,81,82,83},{84,85,86,87,88,89,90,91,92,93}},10},
{16,1,{255},{9},{{86,87,88,89,90,91,92,93,94}},10},
};


MonsterGroup* Monster_lotGroup(const char floor_num) {
	int ii,cnt,rnd_value;
	int index[30];
	cnt = 0;
	rnd_value = Util_random_int_range(0,255);

	for(ii=0;ii<30;ii++) {
		if(MONSTER_GRP_MST[ii].floor == floor_num) {
			index[cnt] = ii;
			cnt++;
		}
	}

	for(ii=cnt-1;ii>=0;ii--) {
		if(MONSTER_GRP_MST[index[ii]].group_hit_rate >= rnd_value) {
			return &MONSTER_GRP_MST[index[ii]];
		}
	}

	return 0;
}


void Monster_clearParty(MonsterData* party[4][9]) {
	int ii,jj;
	for(ii=0;ii<4;ii++) {
		for(jj=0;jj<9;jj++) {
			if(party[ii] && party[ii][jj]) {
				free_ex(party[ii][jj]);
				party[ii][jj] = 0;
			}
		}
	}
}


void Monster_lotMonster(const MonsterGroup* group, MonsterData* party[4][9], char* group_length, int floor) {
	int monster_id_index;
	int rnd_value;
	int ii,group_ii;
	int monster_id  = 0;
	int encount_num = 0;
	int group_num   = Util_random_int_range(1, MAX_GROUP[floor-1]);
	int back_monster_id = -1;

	MonsterData *targetMonster;

	for(group_ii=0;group_ii<group_num;group_ii++) {


		// back_monster_idが-1以外のときは後続モンスターが決定している状態.
		if(back_monster_id == -1) {

			// 抽選用乱数.
			rnd_value 		 = Util_random_int_range(0, 255);
			// モンスターテーブルのindex.
			monster_id_index = Util_random_int_range(0, group->id_length[0]);
			// 抽選.
			for(ii=0;ii<group->group_count;ii++) {
				if(group->hit_rates[ii] >= rnd_value || ii == group->group_count - 1) {
					monster_id = group->ids[ii][monster_id_index];
					break;
				}
			}			
		}else{
			// 後続が決定している場合は採用.
			monster_id = back_monster_id;
		}

		// 出現が決定したモンスターの出現数抽選.
		targetMonster = &MONSTER_MST[monster_id];
		encount_num = Dice_lot(&(targetMonster->encount_dice));
		group_length[group_ii] = encount_num;
		Battle_monster_id_in_group[group_ii] = targetMonster->id;

		// 呪文レベル.
		Battle_monster_magic_lv_in_group[group_ii]  = targetMonster->mage_lv;
		Battle_monster_priest_lv_in_group[group_ii] = targetMonster->priest_lv;

		// 生存者数.
		Battle_monster_alives_in_group[group_ii] = encount_num;

		// 出現数分モンスターデータをコピー.
		for(ii=0;ii<encount_num;ii++) {
			party[group_ii][ii] = malloc_ex(sizeof(MonsterData));
			memcpy(party[group_ii][ii], &MONSTER_MST[monster_id], sizeof(MonsterData));
			// HP, LV, STATUS.
			Battle_member_hp[6 + group_ii*9 + ii] 		= Dice_lot(&(targetMonster->hp_dice));
			Battle_member_hp_max[6 + group_ii*9 + ii] 	= Battle_member_hp[6 + group_ii*9 + ii];
			Battle_member_lv[6 + group_ii*9 + ii] 		= targetMonster->hp_dice.amount; 
			Battle_monster_ac[group_ii*9 + ii]			= targetMonster->ac;
			Battle_monster_status[group_ii][ii]			= STATUS_OK;
		}

		// 後続モンスター抽選.
		rnd_value = Util_random_int_range(1, 255);
		if(targetMonster->back_monster_rate >= rnd_value) {
			back_monster_id = targetMonster->back_monster_id;
		}else{
			back_monster_id = -1;
		}
	}
}